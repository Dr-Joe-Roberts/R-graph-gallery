---
title: "Waffle chart with split by countries"
descriptionMeta: "This post explains how to create a waffle chart with nice features such as annotations and others, using R and ggplot2. It provides a reproducible code and an explanation of it."
descriptionTop: "This post explains how to create a [waffle chart](https://r-graph-gallery.com/waffle.html) with nice features such as **annotations** and others, using R and [ggplot2](https://r-graph-gallery.com/ggplot2-package.html). It provides a reproducible code and an explanation of it."
sectionText: "Waffle section"
sectionLink: "waffle.html"
DataToVizText: "Data to Viz"
DataToVizLink: "data-to-viz.com"
url: "web-dumbell-chart"
output:
  html_document:
      self_contained: false    
      mathjax: default
      lib_dir: libs
      template: template_rgg.html
      css: style.css
      toc: TRUE
      toc_float: TRUE
      toc_depth: 2
      df_print: "paged"
editor_options: 
  chunk_output_type: console
---


```{r global options, include = FALSE}
knitr::opts_chunk$set(
  warning=FALSE, 
  message=FALSE#,
  #fig.align='center'
)
```

<div class="container" style="padding-top: 100px">




# About
***

The chart we want to reproduce is a [waffle life chart](https://r-graph-gallery.com/waffle.html) about the life of a person.

It has been created by [Isabella](https://isabella-b.com/blog/my-life-in-months/). Thanks to her for accepting sharing his work here!

As a teaser, here's the chart we want to reproduce:

<div style="text-align: center;">
  <img src="img/graph/web-waffle-life-chart.png" alt="Waffle Chart" style="width: 100%; max-width: 600px; height: auto;">
</div>

# Libraries

In order to create this chart, we will use the following **libraries**:

- `tidyverse` to manipulate the data
- `waffle` to create waffle charts
- `hrbrthemes` to use a nice theme
- `extrafont` to load fonts
- `lubridate` to manipulate dates


```{r}
library(tidyverse)
library(lubridate)
library(waffle)
library(hrbrthemes)
library(extrafont)

# load fonts
loadfonts(device = "pdf", quiet=TRUE)
```


# Data

For this chart, we manually create a dataset that contains the number of months in each era of a person's life. The dataset contains the following columns:

- `months`: the month of the year
- `age`: the age of the person
- `era`: the era of the person's life

```{r}
life_data <-
  tibble(months = factor(rep(month.abb[1:12], 72), levels=month.abb[1:12])) %>%   ## make months
  slice(4:(n()-9)) %>%  ## remove months in 1996 before my birth month (April)
  tibble(
    age = rep(0:70, each = 12) ## age range: 1-70
  ) %>%
  rowid_to_column("row_name")  ## add column for row number

## add the "eras" to be colored in the waffle chart
life_data <- life_data %>%
  mutate(era = fct_inorder(case_when(
    row_name < 161 ~ "Childhood - US",
    row_name < 207 ~ "High School - PH",
    row_name < 255 ~ "College - PH",
    row_name < 285 ~ "Adulting - PH",
    row_name < ((year(Sys.Date()) - 1996)*12) + (month(Sys.Date()) - 3) ~ "Adulting - US",
    TRUE ~ "Time left")
    )
  )
```




# Create a waffle chart

Now let's actually create the chart. Here is what the code mainly does:

```{r}
life_in_months <- life_data %>%
  count(era) %>% ## the count of each era is the number of months in that era
  ggplot(aes(fill = era, values = n)) +
  geom_waffle(color = "#F7F7F7", n_rows = 12, size = 1, flip = TRUE) + ## make each row a year/12 months
  scale_fill_manual(name = "", values = c("#EF476F","#FCA311","#FFD166","#0EAD69","#4ECDC4","#118AB2")) +  ## assign colors to the eras
  coord_equal() +
  theme_ipsum(grid = "") +
  theme(legend.text = element_text(size = 40),
        plot.background = element_rect(fill = "#F7F7F7", color = "#F7F7F7")) +
  theme_enhance_waffle()

life_in_months
```


<!--<center>
  <img src="img/graph/web-waffle-life-chart.png" width="100%" />
</center>-->

# Going further

This post explains how to create a [waffle life chart](https://r-graph-gallery.com/barplot.html) with nice features such as **annotations**, nice **color** theme and others, using R and [ggplot2](https://r-graph-gallery.com/ggplot2-package.html).

If you want to learn more, you can check the [bar chart section](https://r-graph-gallery.com/barplot.html) of the gallery and [another beautiful bar chart](https://r-graph-gallery.com/web-circular-barplot-with-R-and-ggplot2.html) built with ggplot2.

<!-- Close container -->
</div>

```{r, echo=FALSE}
# Correlation | Ranking | Evolution.. 
htmltools::includeHTML("htmlChunkRelatedRanking.html")
```
